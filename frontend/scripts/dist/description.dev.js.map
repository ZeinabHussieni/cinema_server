{"version":3,"sources":["description.js"],"names":["urlParams","URLSearchParams","window","location","search","movieId","get","axios","params","id","then","response","data","movie","movie_cast","includes","split","actorName","roleName","document","querySelector","textContent","title","innerHTML","description","ratings","status","release_date","poster","src","poster_url","alt","trailerLink","trailers","replace","alert","message","error","console","selectedShowtimeId","selectedSeatsArray","movie_id","res","showtimes","length","select","getElementById","forEach","showtime","option","createElement","value","Date","show_datetime","toLocaleString","appendChild","loadTakenSeats","addEventListener","e","target","err","renderSeats","takenSeats","seatsGrid","ROWS","COLS","totalSeats","seatNum","seat","classList","add","setAttribute","disabled","contains","remove","filter","s","push","log","showtimeId","showtime_id","userId","localStorage","getItem","quantity","post","user_id","seat_numbers","success"],"mappings":"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","sourcesContent":["const urlParams = new URLSearchParams(window.location.search);\r\nconst movieId = urlParams.get('id');\r\n\r\nif (movieId) {\r\n  axios.get(\"http://localhost/cinema_server/backend/controllers/get_movies.php\", {\r\n    params: { id: movieId }\r\n  }).then(response => {\r\n    const data = response.data;\r\n    if (data.movie) {\r\n      const movie = data.movie;\r\n      const [actorName, roleName] = movie.movie_cast && movie.movie_cast.includes('as')\r\n      ? movie.movie_cast.split('as')\r\n      : [\"Unknown\", \"Unknown\"];\r\n\r\n      //here to update the content in the page\r\n      document.querySelector('.heading').textContent = movie.title;\r\n\r\n      document.querySelector('.movie-details').innerHTML = `\r\n        <p><strong>Description:</strong> ${movie.description}</p>\r\n        <p><strong>Actor Name:</strong> ${actorName}</p>\r\n        <p><strong>Actor Role:</strong> ${roleName}</p>\r\n        <p><strong>Rating:</strong> ${movie.ratings || \"Not rated\"}</p>\r\n        <p><strong>Status:</strong> ${movie.status}</p>\r\n        <p><strong>Release Date:</strong> ${movie.release_date}</p>`;\r\n\r\n      // to update the poster that we have\r\n      const poster = document.querySelector('.poster_url');\r\n      poster.src = movie.poster_url;\r\n      poster.alt = movie.title;\r\n\r\n      // to update the trailer\r\n      const trailerLink = (movie.trailers || \"\").split(\",\")[0]; // in case we have more then one trailers\r\n      document.querySelector('.video-wrapper iframe').src = trailerLink.replace(\"watch?v=\", \"embed/\");//replace it to make iframe understand the url\r\n    } else {\r\n      alert(data.message || \"Movie not found\");\r\n    }\r\n  })\r\n  .catch(error => {\r\n    console.error(\"Axios error:\", error);\r\n    alert(\"Failed to fetch movie data.\");\r\n  });\r\n\r\n} else {\r\n  alert(\"No movie ID provided in the URL\");\r\n}\r\n\r\n//get showtime id\r\n\r\n\r\nlet selectedShowtimeId = null;\r\nlet selectedSeatsArray = [];\r\n\r\nif (movieId) {\r\n  // Fetch movie details here...\r\n\r\n  // Fetch showtimes for movie\r\n  axios.get(\"http://localhost/cinema_server/backend/controllers/get_showtimeId.php\", {\r\n    params: { movie_id: movieId }\r\n  }).then(res => {\r\n    const showtimes = res.data.showtimes;\r\n\r\n    if (showtimes.length === 0) {\r\n      alert(\"No showtimes available\");\r\n      return;\r\n    }\r\n\r\n    const select = document.getElementById(\"showtimeSelect\");\r\n    select.innerHTML = \"\";\r\n\r\n    showtimes.forEach(showtime => {\r\n      const option = document.createElement(\"option\");\r\n      option.value = showtime.id;\r\n      option.textContent = new Date(showtime.show_datetime).toLocaleString();\r\n      select.appendChild(option);\r\n    });\r\n\r\n    selectedShowtimeId = select.value;\r\n    loadTakenSeats(selectedShowtimeId);\r\n\r\n    select.addEventListener(\"change\", (e) => {\r\n      selectedShowtimeId = e.target.value;\r\n      selectedSeatsArray = [];\r\n      loadTakenSeats(selectedShowtimeId);\r\n    });\r\n\r\n  }).catch(err => {\r\n    console.error(\"Error loading showtimes:\", err);\r\n  });\r\n\r\n} else {\r\n  alert(\"No movie ID provided in the URL\");\r\n}\r\nfunction renderSeats(takenSeats) {\r\n  const seatsGrid = document.getElementById(\"seats-grid\");\r\n  seatsGrid.innerHTML = \"\";\r\n\r\n  const ROWS = 5;\r\n  const COLS = 10;\r\n  const totalSeats = ROWS * COLS;\r\n\r\n  for (let seatNum = 1; seatNum <= totalSeats; seatNum++) {\r\n    const seat = document.createElement(\"button\");\r\n    seat.classList.add(\"seat\");\r\n    seat.textContent = seatNum;\r\n\r\n    if (takenSeats.includes(seatNum)) {\r\n      seat.classList.add(\"taken\");\r\n      seat.setAttribute(\"aria-label\", `Seat ${seatNum}, taken`);\r\n      seat.disabled = true; // disable taken seats so user can't click\r\n    } else {\r\n      seat.setAttribute(\"aria-label\", `Seat ${seatNum}, available`);\r\n\r\n      seat.addEventListener(\"click\", () => {\r\n        if (seat.classList.contains(\"selected\")) {\r\n          seat.classList.remove(\"selected\");\r\n          selectedSeatsArray = selectedSeatsArray.filter(s => s !== seatNum);\r\n          seat.setAttribute(\"aria-pressed\", \"false\");\r\n        } else {\r\n          seat.classList.add(\"selected\");\r\n          selectedSeatsArray.push(seatNum);\r\n          seat.setAttribute(\"aria-pressed\", \"true\");\r\n        }\r\n        console.log(\"Selected seats:\", selectedSeatsArray);\r\n      });\r\n\r\n      seat.setAttribute(\"aria-pressed\", \"false\"); // track toggle state for screen readers\r\n      seat.setAttribute(\"role\", \"button\");\r\n    }\r\n\r\n    seatsGrid.appendChild(seat);\r\n  }\r\n}\r\n\r\n\r\nfunction loadTakenSeats(showtimeId) {\r\n  axios.get(\"http://localhost/cinema_server/backend/controllers/show_takenseats.php\", {\r\n    params: { showtime_id: showtimeId }\r\n  }).then(res => {\r\n    const takenSeats = res.data.takenSeats || [];\r\n    renderSeats(takenSeats);\r\n  }).catch(err => {\r\n    console.error(\"Failed to load taken seats\", err);\r\n  });\r\n}\r\n\r\ndocument.querySelector('.ticket-button').addEventListener('click', () => {\r\n  const userId = localStorage.getItem(\"userId\");\r\n  const quantity = selectedSeatsArray.length;\r\n\r\n  if (!selectedShowtimeId || !userId || quantity === 0) {\r\n    alert(\"Missing user, showtime info or no seats selected!\");\r\n    return;\r\n  }\r\n\r\n  axios.post(\"http://localhost/cinema_server/backend/controllers/buy_ticket.php\", {\r\n    user_id: userId,\r\n    movie_id: movieId,\r\n    showtime_id: selectedShowtimeId,\r\n    seat_numbers: selectedSeatsArray,\r\n    quantity: quantity\r\n  }).then(res => {\r\n    if (res.data.success) {\r\n      alert(\"Ticket purchased successfully\");\r\n      // Optionally clear selections or reload seats here\r\n    } else {\r\n      alert(res.data.message || \"Purchase failed\");\r\n    }\r\n  }).catch(err => {\r\n    console.error(\"Error:\", err);\r\n    alert(\"Something went wrong\");\r\n  });\r\n});\r\n"],"file":"description.dev.js"}