"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],r=!0,o=!1,n=void 0;try{for(var s,i=e[Symbol.iterator]();!(r=(s=i.next()).done)&&(a.push(s.value),!t||a.length!==t);r=!0);}catch(e){o=!0,n=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw n}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var urlParams=new URLSearchParams(window.location.search),movieId=urlParams.get("id");movieId?axios.get("http://localhost/cinema_server/backend/controllers/get_movies.php",{params:{id:movieId}}).then(function(e){var t=e.data;if(t.movie){var a=t.movie,r=_slicedToArray(a.movie_cast&&a.movie_cast.includes("as")?a.movie_cast.split("as"):["Unknown","Unknown"],2),o=r[0],n=r[1];document.querySelector(".heading").textContent=a.title,document.querySelector(".movie-details").innerHTML="\n        <p><strong>Description:</strong> ".concat(a.description,"</p>\n        <p><strong>Actor Name:</strong> ").concat(o,"</p>\n        <p><strong>Actor Role:</strong> ").concat(n,"</p>\n        <p><strong>Rating:</strong> ").concat(a.ratings||"Not rated","</p>\n        <p><strong>Status:</strong> ").concat(a.status,"</p>\n        <p><strong>Release Date:</strong> ").concat(a.release_date,"</p>");var s=document.querySelector(".poster_url");s.src=a.poster_url,s.alt=a.title;var i=(a.trailers||"").split(",")[0];document.querySelector(".video-wrapper iframe").src=i.replace("watch?v=","embed/")}else alert(t.message||"Movie not found")}).catch(function(e){console.error("Axios error:",e),alert("Failed to fetch movie data.")}):alert("No movie ID provided in the URL");var selectedShowtimeId=null,selectedSeatsArray=[];function renderSeats(a){var r=document.getElementById("seats-grid");r.innerHTML="";for(var e=function(t){var e=document.createElement("button");e.classList.add("seat"),e.textContent=t,a.includes(t)?(e.classList.add("taken"),e.setAttribute("aria-label","Seat ".concat(t,", taken")),e.disabled=!0):(e.setAttribute("aria-label","Seat ".concat(t,", available")),e.addEventListener("click",function(){e.classList.contains("selected")?(e.classList.remove("selected"),selectedSeatsArray=selectedSeatsArray.filter(function(e){return e!==t}),e.setAttribute("aria-pressed","false")):(e.classList.add("selected"),selectedSeatsArray.push(t),e.setAttribute("aria-pressed","true")),console.log("Selected seats:",selectedSeatsArray)}),e.setAttribute("aria-pressed","false"),e.setAttribute("role","button")),r.appendChild(e)},t=1;t<=50;t++)e(t)}function loadTakenSeats(e){axios.get("http://localhost/cinema_server/backend/controllers/show_takenseats.php",{params:{showtime_id:e}}).then(function(e){renderSeats(e.data.takenSeats||[])}).catch(function(e){console.error("Failed to load taken seats",e)})}movieId?axios.get("http://localhost/cinema_server/backend/controllers/get_showtimeId.php",{params:{movie_id:movieId}}).then(function(e){var t=e.data.showtimes;if(0!==t.length){var a=document.getElementById("showtimeSelect");a.innerHTML="",t.forEach(function(e){var t=document.createElement("option");t.value=e.id,t.textContent=new Date(e.show_datetime).toLocaleString(),a.appendChild(t)}),loadTakenSeats(selectedShowtimeId=a.value),a.addEventListener("change",function(e){selectedShowtimeId=e.target.value,selectedSeatsArray=[],loadTakenSeats(selectedShowtimeId)})}else alert("No showtimes available")}).catch(function(e){console.error("Error loading showtimes:",e)}):alert("No movie ID provided in the URL"),document.querySelector(".ticket-button").addEventListener("click",function(){var e=localStorage.getItem("userId"),t=selectedSeatsArray.length;selectedShowtimeId&&e&&0!==t?axios.post("http://localhost/cinema_server/backend/controllers/buy_ticket.php",{user_id:e,movie_id:movieId,showtime_id:selectedShowtimeId,seat_numbers:selectedSeatsArray,quantity:t}).then(function(e){e.data.success?alert("Ticket purchased successfully"):alert(e.data.message||"Purchase failed")}).catch(function(e){console.error("Error:",e),alert("Something went wrong")}):alert("Missing user, showtime info or no seats selected!")});
//# sourceMappingURL=description.min.js.map
